<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    
    <head>
   <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-106786912-1">
    </script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments)};
      gtag('js', new Date());
      gtag('config', 'UA-106786912-1');
    </script>


     <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <!--
      loads the http over https ssl -
      welcome to my website!

	this theme is based off the Ice & Fire theme created by Lucas Gatsas
      https://www.twitter.com/LucasGatsas
      www.lucasgatsas.ch - switzerland.
  -->


<!-- Microsoft Internet Explorer documentMode compatMode setting IE Modus -->
<script type="text/javascript">
var IE = null;
if (window.navigator.appName == "Microsoft Internet Explorer") {
  if (document.documentMode) {

    IE = document.documentMode;
    } else {

        IE = 5;
          if (document.compatMode) {
      if (document.compatMode == "CSS1Compat")
      IE = 11;
      }
    }
  }
</script>

    <meta charset="utf-8">
    <!-- X-UA -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <link rel="author" title="Ranjit Jhala" href="http://ranjitjhala.github.io" />

    <meta name="google" content="notranslate" />
    <!-- Viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- index ROBOTS follow -->
    <meta name="robots" content="index, follow" />
    <!-- Site Desciption -->
    <meta name="description" content="LiquidHaskell Blog">
    <!-- Site Desciption -->
    <meta name="keywords" content="haskell, refinement types, liquid types, formal methods, type systems">
    <!-- Favicon -->
    <link rel="shortcut icon" href="https://ucsd-progsys.github.io/liquidhaskell-blog/static/img/ico.png" type="image/x-icon" />
    <!-- Blog Title -->
    <title>LiquidHaskell</title>

    <!--     <title>{% if page.title %}{{ page.title }} - {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
-->
    <!-- Property Metas -->
    <meta property="og:image" content="https://ucsd-progsys.github.io/liquidhaskell-blog/static/img/ix.png" />
    <meta property="og:title" content="LiquidHaskell Blog" />
    <meta property="og:site_name" content="LiquidHaskell Blog" />
    <!-- Canonical -->
    <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseUrl | prepend: site.url }}">
    <!-- StyleSheet -->
    <link rel="stylesheet" href="https://ucsd-progsys.github.io/liquidhaskell-blog/static/css/bootstrap.min.css">
    <!-- <link rel="stylesheet" href="https://ucsd-progsys.github.io/liquidhaskell-blog/static/css/spaceg.stylesheets.css"> -->
    <link rel="stylesheet" href="https://ucsd-progsys.github.io/liquidhaskell-blog/static/css/ronacher.css" type="text/css">

    <link rel="stylesheet" href="https://ucsd-progsys.github.io/liquidhaskell-blog/static/css/syntax.css">
    <link rel="stylesheet" href="https://ucsd-progsys.github.io/liquidhaskell-blog/static/css/liquid-light.css">

    <!-- Fonts
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Playfair+Display:400,700,900,400italic,700italic,900italic' rel='stylesheet' type='text/css'>
    -->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
	#preloader {position:fixed;top:0;left:0;right:0;bottom:0;background-color:#fff; /* change if the mask should have another color then white */z-index:99; /* makes sure it stays on top */}
	#status {width:200px;height:200px;position:absolute;left:50%; /* centers the loading animation horizontally one the screen */top:50%; /* centers the loading animation vertically one the screen */background-image:url("/static/img/preloader.gif"); /* path to your loading animation */background-repeat:no-repeat;background-position:center;margin:-100px 0 0 -100px; /* is width and height divided by two */}
	ul, ol {margin-top: 0;margin-bottom: 10px;}
	.navbar-inverse {background-color: #FFF;border-color: #FFFFFF;}
</style>
<!--link rel="stylesheet" href="https://ucsd-progsys.github.io/liquidhaskell-blog/static/css/prettify.css"-->
<style>
  /* HEADER IMAGE */
  header.intro-header {background: #6f5499;background: no-repeat center center;background-attachment: scroll;-webkit-background-size: cover;-moz-background-size: cover;background-size: cover;-o-background-size: cover;}

	/* Preloader */#preloader {position:fixed;top:0;left:0;right:0;bottom:0;background-color:#fff; /* change if the mask should have another color then white */z-index:99; /* makes sure it stays on top */}
	#status {width:200px;height:200px;position:absolute;left:50%; /* centers the loading animation horizontally one the screen */top:50%; /* centers the loading animation vertically one the screen */background-image:; /* path to your loading animation */background-repeat:no-repeat;background-position:center;margin:-100px 0 0 -100px; /* is width and height divided by two */}
	li {list-style: none;}
            body.modal-open
            {overflow: hidden;padding-right: 0px;
        }
	article li {list-style: inherit;}
	article .figure {text-align: center}
    </style>
    <!-- end Loading front stylesheet here -->

    <link href="atom.xml" type="application/atom+xml" rel="alternate" title="LiquidHaskell-Blog ATOM Feed" />
    </head>

    <body>
	    
	<!-- 	
        <div id="preloader">
	    <div id="status">
	    </div>
	</div>  
	-->
	<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://ucsd-progsys.github.io/liquidhaskell-blog" id="blog-title-left-top">LiquidHaskell</a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- <li class="dropdown">
                    <a href="#portfolioModal2" data-toggle="modal"><i class="fa fa-random" id="icon-top"></i></a>
                <ul class="dropdown-menu"></ul>
                </li>-->
                
                <li><a href="https://ucsd-progsys.github.io/liquidhaskell-blog/blog.html">Blog</a></li>
                <li><a href="http://goto.ucsd.edu:8090/index.html#?demo=MeasuresAndCaseSplitting.hs" target="_blank">Demo</a></li>
                <li><a href="http://ucsd-progsys.github.io/lh-workshop" target="_blank">Tutorial</a></li>
                <li><a href="http://ucsd-progsys.github.io/liquidhaskell-tutorial" target="_blank">Book</a></li>
                <li><a href="https://ucsd-progsys.github.io/liquidhaskell-blog/about.html" target="_blank">About</a></li>
                <li><a href="http://www.github.com/ucsd-progsys/liquidhaskell" target="_blank"><i class="fa fa-twitter"></i>Download</a></li>
                <!--
                <li><a href="https://www.twitter.com/ranjitjhala" id="roundbutton" target="_blank"><i class="fa fa-twitter"></i>RanjitJhala</a></li>
                -->
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<!-- Portfolio Modals -->
    <div class="portfolio-modal modal fade" id="portfolioModal1" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <h1 class="font-style-inline-small-h1">Ranjit Jhala</h1>
                            <hr class="star-primary">
                            <img src="https://ucsd-progsys.github.io/liquidhaskell-blog/static/img/ico.png" class="img-responsive img-centered" alt title>
                            <p class="font-style-inline-small">
                                <a href="https://www.twitter.com/ranjitjhala" target="_blank">follow me</a>. <br>
                                <a href="https://www.github.com/ucsd-progsys" target="_blank">    <i class="fa fa-github" id="spaceg-social-modal"></i> </a>
                                <a href="https://www.twitter.com/ranjitjhala" target="_blank"><i class="fa fa-twitter" id="spaceg-social-modal"></i> </a>
                                <a href="https://plus.google.com/u/0/106612421534244742464" target="_blank"> <i class="fa fa-google-plus" id="spaceg-social-modal"></i></a>
                            </p>
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<!-- Menu Modals Add New Sa.21.Feb.2015 03:22:25 -->
    <div class="portfolio-modal modal fade" id="portfolioModal2" tabindex="-1" role="dialog" aria-hidden="true" style="padding-right:0px; overflow: hidden;">
        <div class="modal-content">
            <div class="close-modal" data-dismiss="modal">
                <div class="lr">
                    <div class="rl">
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2">
                        <div class="modal-body">
                            <h1 class="font-style-inline-small-h1">Ranjit Jhala</h1>
                            <hr class="star-primary">
                            <p class="font-style-inline-small">
                        <a href="https://www.twitter.com/ranjitjhala" target="_blank">follow</a>. <br>
                        <a href="https://www.github.com/ucsd-progsys" target="_blank">    <i class="fa fa-github" id="spaceg-social-modal"></i> </a>
                        <a href="https://www.twitter.com/ranjitjhala" target="_blank"><i class="fa fa-twitter" id="spaceg-social-modal"></i> </a>
                        <a href="https://plus.google.com/u/0/106612421534244742464" target="_blank"> <i class="fa fa-google-plus" id="spaceg-social-modal"></i></a>  <br>
                    <li><a href="https://ucsd-progsys.github.io/liquidhaskell-blog/index.html">Home</a></li>
                    <li><a href="https://ucsd-progsys.github.io/liquidhaskell-blog/about.html">About</a></li>
                    <li><a href="https://ucsd-progsys.github.io/liquidhaskell-blog/blog.html">Blog</a></li>
                    <li><a href="http://goto.ucsd.edu:8090/index.html#?demo=MeasuresAndCaseSplitting.hs" target="_blank">Demo</a></li>
                    <li><a href="http://ucsd-progsys.github.io/lh-workshop" target="_blank">Tutorial</a></li>
                    <li><a href="http://ucsd-progsys.github.io/liquidhaskell-tutorial" target="_blank">Book</a></li>
                    <li><a href="http://www.github.com/ucsd-progsys/liquidhaskell" target="_blank"><i class="fa fa-twitter"></i>Download</a></li>
                            </p>

                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


        <div id="content">
            <!-- Post Header -->
<header class="intro-header" style="background-image: url('https://ucsd-progsys.github.io/liquidhaskell-blog/static/img/sea.jpg')" alt title>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Measures and Case Splitting</h1>
                    
                    <span class="meta">
		    
			Posted by Niki Vazou
		    
			Feb 23, 2018
		    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

            <br>

            <div class="info">
              
                Tags: <a title="All pages tagged 'measures'." href="../../../../tags/measures.html">measures</a>, <a title="All pages tagged 'advanced'." href="../../../../tags/advanced.html">advanced</a>
              
            </div>

            <br>
			            <p>Liquid Haskell has a flag called <code>--no-case-expand</code>
which can make verification of your code much faster,
especially when your code is using ADTs with many alternatives.
This flag says relax precision to get fast verification,
thus may lead to rejecting safe code.</p>
<p>In this post, I explain how <code>--no-case-expand</code>
works using a trivial example!</p>
<p>(Click here to <a href="http://goto.ucsd.edu:8090/index.html#?demo=RangeSet.hs">demo</a>)</p>
<!-- more -->
<div class="hidden">
<pre><span class="hs-linenum">28: </span>
<span class="hs-linenum">29: </span><span class="hs-keyword">module</span> <span class="hs-conid">MeasuresAndCaseSplitting</span> <span class="hs-keyword">where</span>
</pre>
</div>
<h2 id="measures">Measures</h2>
<p>Letâ€™s define a simple data type with three alternatives</p>
<pre><span class="hs-linenum">40: </span><span class="hs-keyword">data</span> <span class="hs-conid">ABC</span> <span class="hs-keyglyph">=</span> <span class="hs-conid">A</span> <span class="hs-keyglyph">|</span> <span class="hs-conid">B</span> <span class="hs-keyglyph">|</span> <span class="hs-conid">C</span> 
</pre>
<p>and a measure that turns <code>ABD</code> into an integer</p>
<pre><span class="hs-linenum">46: </span><span class="hs-keyword">{-@</span> <span class="hs-varid">measure</span> <span class="hs-varid">toInt</span> <span class="hs-keyword">@-}</span>
<span class="hs-linenum">47: </span><span class="hs-definition">toInt</span> <span class="hs-keyglyph">::</span> <span class="hs-conid">ABC</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">Int</span> 
<span class="hs-linenum">48: </span><a class="annot" href="#"><span class="annottext">x1:MeasuresAndCaseSplitting.ABC -&gt; {VV : GHC.Types.Int | VV == MeasuresAndCaseSplitting.toInt x1}</span><span class="hs-definition">toInt</span></a> <span class="hs-conid">A</span> <span class="hs-keyglyph">=</span> <span class="hs-num">1</span> 
<span class="hs-linenum">49: </span><span class="hs-definition">toInt</span> <span class="hs-conid">B</span> <span class="hs-keyglyph">=</span> <span class="hs-num">2</span>
<span class="hs-linenum">50: </span><span class="hs-definition">toInt</span> <span class="hs-conid">C</span> <span class="hs-keyglyph">=</span> <span class="hs-num">3</span> 
</pre>
<p>Though obvious to us, Liquid Haskell will fail to check
that <code>toInt</code> of any <code>ABC</code> argument
gives back a natural number.
Or, the following call leads to a refinement type error.</p>
<pre><span class="hs-linenum">59: </span><span class="hs-keyword">{-@</span> <span class="hs-keyword">unsafe</span> <span class="hs-keyglyph">::</span> <span class="hs-varid">x</span><span class="hs-conop">:</span><span class="hs-conid">ABC</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyword">{o:</span><span class="hs-conid">()</span> <span class="hs-keyword">| 0 &lt;= toInt x }</span> <span class="hs-keyword">@-}</span>
<span class="hs-linenum">60: </span><span class="hs-keyword">unsafe</span>     <span class="hs-keyglyph">::</span> <span class="hs-conid">ABC</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">()</span> 
<span class="hs-linenum">61: </span><span class="hs-error"><a class="annot" href="#"><span class="annottext">x1:MeasuresAndCaseSplitting.ABC -&gt; {o : () | 0 &lt;= MeasuresAndCaseSplitting.toInt x1}</span><span class="hs-keyword">unsafe</span></a></span> <a class="annot" href="#"><span class="annottext">MeasuresAndCaseSplitting.ABC</span><span class="hs-varid">x</span></a>   <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span>
</pre>
<p>Why?
By turning <code>toInt</code> into a measure, Liquid Haskell
gives precise information to each data constructor of <code>ABC</code>.
Thus it knows that <code>toInt</code> or <code>A</code>, <code>B</code>, and <code>C</code>
is respectively <code>1</code>, <code>2</code>, and <code>3</code>, by <em>automatically</em>
generating the following types:</p>
<pre><span class="hs-linenum">72: </span><span class="hs-conid">A</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">{</span><span class="hs-varid">v</span><span class="hs-conop">:</span><span class="hs-conid">ABC</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">toInt</span> <span class="hs-varid">v</span> <span class="hs-varop">==</span> <span class="hs-num">1</span> <span class="hs-layout">}</span>
<span class="hs-linenum">73: </span><span class="hs-conid">B</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">{</span><span class="hs-varid">v</span><span class="hs-conop">:</span><span class="hs-conid">ABC</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">toInt</span> <span class="hs-varid">v</span> <span class="hs-varop">==</span> <span class="hs-num">2</span> <span class="hs-layout">}</span>
<span class="hs-linenum">74: </span><span class="hs-conid">C</span> <span class="hs-keyglyph">::</span> <span class="hs-layout">{</span><span class="hs-varid">v</span><span class="hs-conop">:</span><span class="hs-conid">ABC</span> <span class="hs-keyglyph">|</span> <span class="hs-varid">toInt</span> <span class="hs-varid">v</span> <span class="hs-varop">==</span> <span class="hs-num">3</span> <span class="hs-layout">}</span>
</pre>
<p>Thus, to get the <code>toInt</code> information one need to
explicitly perform case analysis on an <code>ABC</code> argument.
The following code is safe</p>
<pre><span class="hs-linenum">82: </span><span class="hs-keyword">{-@</span> <span class="hs-keyword">safe</span> <span class="hs-keyglyph">::</span> <span class="hs-varid">x</span><span class="hs-conop">:</span><span class="hs-conid">ABC</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyword">{o:</span><span class="hs-conid">()</span> <span class="hs-keyword">| 0 &lt;= toInt x}</span> <span class="hs-keyword">@-}</span>
<span class="hs-linenum">83: </span><span class="hs-keyword">safe</span>     <span class="hs-keyglyph">::</span> <span class="hs-conid">ABC</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">()</span>
<span class="hs-linenum">84: </span><a class="annot" href="#"><span class="annottext">x1:MeasuresAndCaseSplitting.ABC -&gt; {o : () | 0 &lt;= MeasuresAndCaseSplitting.toInt x1}</span><span class="hs-keyword">safe</span></a> <span class="hs-conid">A</span>   <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span> 
<span class="hs-linenum">85: </span><span class="hs-keyword">safe</span> <span class="hs-conid">B</span>   <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span> 
<span class="hs-linenum">86: </span><span class="hs-keyword">safe</span> <span class="hs-conid">C</span>   <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span> 
</pre>
<p>Liquid Haskell type check the above code because
in the first case the body is checked under the assumption
that the argument, call it <code>x</code>, is an <code>A</code>.
Under this assumption, <code>toInt x</code> is indeed non negative.
Yet, this is the case for the rest two alternatives,
where <code>x</code> is either <code>B</code> or <code>C</code>.
So, <code>0 &lt;= toInt x</code> holds for all the alternatives,
because case analysis on <code>x</code> automatically reasons about the
value of the measure <code>toInt</code>.</p>
<p>Now, what if I match the argument <code>x</code> only with <code>A</code>
and provide a default body for the rest?</p>
<pre><span class="hs-linenum">104: </span><span class="hs-keyword">{-@</span> <span class="hs-varid">safeBut</span> <span class="hs-keyglyph">::</span> <span class="hs-varid">x</span><span class="hs-conop">:</span><span class="hs-conid">ABC</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyword">{o:</span><span class="hs-conid">()</span> <span class="hs-keyword">| 0 &lt;= toInt x}</span> <span class="hs-keyword">@-}</span>
<span class="hs-linenum">105: </span><span class="hs-definition">safeBut</span>     <span class="hs-keyglyph">::</span> <span class="hs-conid">ABC</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">()</span>
<span class="hs-linenum">106: </span><a class="annot" href="#"><span class="annottext">x1:MeasuresAndCaseSplitting.ABC -&gt; {o : () | 0 &lt;= MeasuresAndCaseSplitting.toInt x1}</span><span class="hs-definition">safeBut</span></a> <span class="hs-conid">A</span>   <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span> 
<span class="hs-linenum">107: </span><span class="hs-definition">safeBut</span> <span class="hs-keyword">_</span>   <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span> 
</pre>
<p>Liquid Haskell knows that if the argument <code>x</code> is actually an <code>A</code>,
then <code>toInt x</code> is not negative, but does not know the value of <code>toInt</code>
for the default case.</p>
<p>But, <em>by default</em> Liquid Haskell will do the the case expansion
of the default case for you and rewrite your code to match <code>_</code>
with all the possible cases.
Thus, Liquid Haskell will internally rewrite <code>safeBut</code> as</p>
<pre><span class="hs-linenum">119: </span><span class="hs-keyword">{-@</span> <span class="hs-varid">safeButLH</span> <span class="hs-keyglyph">::</span> <span class="hs-varid">x</span><span class="hs-conop">:</span><span class="hs-conid">ABC</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-keyword">{o:</span><span class="hs-conid">()</span> <span class="hs-keyword">| 0 &lt;= toInt x}</span> <span class="hs-keyword">@-}</span>
<span class="hs-linenum">120: </span><span class="hs-definition">safeButLH</span>     <span class="hs-keyglyph">::</span> <span class="hs-conid">ABC</span> <span class="hs-keyglyph">-&gt;</span> <span class="hs-conid">()</span>
<span class="hs-linenum">121: </span><a class="annot" href="#"><span class="annottext">x1:MeasuresAndCaseSplitting.ABC -&gt; {o : () | 0 &lt;= MeasuresAndCaseSplitting.toInt x1}</span><span class="hs-definition">safeButLH</span></a> <span class="hs-conid">A</span>   <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span> 
<span class="hs-linenum">122: </span><span class="hs-definition">safeButLH</span> <span class="hs-conid">B</span>   <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span> 
<span class="hs-linenum">123: </span><span class="hs-definition">safeButLH</span> <span class="hs-conid">C</span>   <span class="hs-keyglyph">=</span> <span class="hs-conid">()</span> 
</pre>
<p>With this rewrite Liquid Haskell gets precision!
Thus, it has all the information it needs to prove <code>safeBut</code> as safe.
Yet, it repeats the code of the default case,
thus verification slows down.</p>
<p>In this example, we only have three case alternatives,
so we only repeat the code two times with a minor slow down.
In cases with many more alternatives repeating the code
of the default case can kill the verification time.</p>
<p>For that reason, Liquid Haskell comes with the <code>no-case-expand</code>
flag that deactivates this expansion of the default cases.
With the <code>no-case-expand</code> flag on, the <code>safeBut</code> code will not type check
and to fix it the user needs to perform the case expansion manually.</p>
<p>In short, the <code>no-case-expand</code> increases verification speed
but reduces precision. Then it is up to the user
to manually expand the default cases, as required,
to restore all the precision required for the code to type check.</p>
                <hr>
                <ul class="pager">
                    
                    
                </ul>

                <div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    var disqus_config = function () {
        this.page.url        = 'https://ucsd-progsys.github.io/liquidhaskell-blog/2018/02/23/measures-and-case-splitting.lhs';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = '/2018/02/23/measures-and-case-splitting.lhs';           // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
        var d = document, s = d.createElement('script');
        s.src = '//liquidhaskell.disqus.com/embed.js';  // IMPORTANT: Replace EXAMPLE with your forum shortname!
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


            </div>
        </div>
    </div>
</article>

        </div>
        <div id="footer">
        </div>
      <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="https://ucsd-progsys.github.io/liquidhaskell-blog/feed.xml" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/ranjitjhala" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme" target="_blank">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://plus.google.com/u/0/106612421534244742464" data-datatype="json" data-type="GET" data-target="#frame" class="reload" id="clickme" target="_blank">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-google-plus fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/ucsd-progsys" target="_blank">
                            <span class="fa-stack fa-lg">

                              <i class="fa fa-arrow-circle-o-down"></i>
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
		    
                </ul>
                <p class="copyright text-muted">
                
                  Copyright &copy; Niki Vazou 2016-17.
                
                  Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>,
                  template by <a href="http://lucumr.pocoo.org">Armin Ronacher</a>,
                  suggest improvements <a href="https://github.com/ucsd-progsys/liquidhaskell-blog/">here</a>.
                </p>
            </div>
        </div>
    </div>
</footer>


<!-- jQuery -->
<script src="https://ucsd-progsys.github.io/liquidhaskell-blog/static/js/jquery.min.js"></script>
<script src="https://ucsd-progsys.github.io/liquidhaskell-blog/static/js/spaceg.stylesheets.min.js"></script>
<script src="https://ucsd-progsys.github.io/liquidhaskell-blog/static/js/bootstrap.min.js"></script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
<script src="https://ucsd-progsys.github.io/liquidhaskell-blog/static/js/anim.js"></script>
<script src="https://ucsd-progsys.github.io/liquidhaskell-blog/static/js/scripts.js"></script>

    </body>
</html>
